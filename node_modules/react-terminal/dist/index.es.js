import*as e from"react";import n from"prop-types";import{isMobile as t}from"react-device-detect";var o=function(){return o=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},o.apply(this,arguments)};function r(e,n,t,o){return new(t||(t=Promise))((function(r,a){function l(e){try{c(o.next(e))}catch(e){a(e)}}function i(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(l,i)}c((o=o.apply(e,n||[])).next())}))}function a(e,n){var t,o,r,a,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;l;)try{if(t=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return l.label++,{value:a[1],done:!1};case 5:l.label++,o=a[1],a=[0];continue;case 7:a=l.ops.pop(),l.trys.pop();continue;default:if(!(r=l.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){l=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){l.label=a[1];break}if(6===a[0]&&l.label<r[1]){l.label=r[1],r=a;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(a);break}r[2]&&l.ops.pop(),l.trys.pop();continue}a=n.call(e,l)}catch(e){a=[6,e],o=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}}!function(e,n){void 0===n&&(n={});var t=n.insertAt;if(e&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===t&&o.firstChild?o.insertBefore(r,o.firstChild):o.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}('@import url("https://fonts.googleapis.com/css?family=Source+Code+Pro&display=swap");\n#index_terminalContainer__3q4m3 {\n  --control-default-bg-color: #ccc;\n  --control-close-bg-color: #fc5b57;\n  --control-minimize-bg-color: #e5bf3c;\n  --control-maximize-bg-color: #57c038;\n}\n\n.index_controls__9z-dM {\n  text-align: left;\n  height: 26px;\n  position: relative;\n  top: 4px;\n  margin-left: 4px;\n}\n.index_controls__9z-dM .index_consoleCtrl__PQnAL {\n  display: inline-block;\n  width: 13px;\n  height: 13px;\n  margin: 0 3px;\n  border-radius: 50%;\n  background: var(--control-default-bg-color);\n}\n.index_controls__9z-dM .index_close__2o6CK {\n  background: var(--control-close-bg-color);\n}\n.index_controls__9z-dM .index_minimize__E9mwB {\n  background: var(--control-minimize-bg-color);\n}\n.index_controls__9z-dM .index_maximize__sbbYF {\n  background: var(--control-maximize-bg-color);\n}\n\n.index_editor__2tqRz {\n  text-align: left;\n  height: 100%;\n  padding: 10px 15px;\n  overflow-wrap: break-word;\n  overflow-y: scroll;\n  outline: none;\n  font-family: "Source Code Pro", monospace;\n  font-size: 18px;\n  line-height: 22px;\n  border-bottom-left-radius: 5px;\n  border-bottom-right-radius: 5px;\n}\n.index_editor__2tqRz .index_mobileInput__jGtyc {\n  position: absolute;\n  top: -2000px;\n  left: -2000px;\n}\n.index_editor__2tqRz .index_lineText__2Poex {\n  display: inline;\n  position: relative;\n  top: -1px;\n  margin-left: 8px;\n}\n.index_editor__2tqRz .index_preWhiteSpace__3nCT2 {\n  white-space: pre-wrap;\n}\n.index_editor__2tqRz .index_caret__MYxcn {\n  position: relative;\n  -webkit-animation: index_blink__RQDX- 0.75s ease-in-out infinite;\n  -moz-animation: index_blink__RQDX- 0.75s ease-in-out infinite;\n  -o-animation: index_blink__RQDX- 0.75s ease-in-out infinite;\n  -ms-animation: index_blink__RQDX- 0.75s ease-in-out infinite;\n  animation: index_blink__RQDX- 0.75s ease-in-out infinite;\n}\n.index_editor__2tqRz .index_caret__MYxcn .index_caretAfter__2B8sk {\n  content: "";\n  position: absolute;\n  top: 2px;\n  width: 10px;\n  height: 22px;\n  z-index: 10;\n}\n@-moz-keyframes index_blink__RQDX- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0);\n  }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none;\n  }\n}\n@-webkit-keyframes index_blink__RQDX- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0);\n  }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none;\n  }\n}\n@-o-keyframes index_blink__RQDX- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0);\n  }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none;\n  }\n}\n@keyframes index_blink__RQDX- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0);\n  }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none;\n  }\n}\n.index_editor__2tqRz a {\n  color: #1a87b5;\n}\n\n.index_editorWithTopBar__3SFSM {\n  height: calc(100% - 46px);\n}\n\n.index_curvedTop__3RecJ {\n  border-top-left-radius: 5px;\n  border-top-right-radius: 5px;\n}\n\n#index_terminalContainer__3q4m3 {\n  height: 100%;\n}\n\n.index_terminal__1dSq1 {\n  height: 100%;\n  width: 100%;\n  margin: auto;\n  border-radius: 5px;\n}');var l={terminalContainer:"index_terminalContainer__3q4m3",controls:"index_controls__9z-dM",consoleCtrl:"index_consoleCtrl__PQnAL",close:"index_close__2o6CK",minimize:"index_minimize__E9mwB",maximize:"index_maximize__sbbYF",editor:"index_editor__2tqRz",mobileInput:"index_mobileInput__jGtyc",lineText:"index_lineText__2Poex",preWhiteSpace:"index_preWhiteSpace__3nCT2",caret:"index_caret__MYxcn",blink:"index_blink__RQDX-",caretAfter:"index_caretAfter__2B8sk",editorWithTopBar:"index_editorWithTopBar__3SFSM",curvedTop:"index_curvedTop__3RecJ",terminal:"index_terminal__1dSq1"},i=e.createContext(null),c=function(n){var t=n.children;return e.createElement(i.Provider,{value:l},t)},s={dark:{themeBGColor:"#022833",themeToolbarColor:"#131519",themeColor:"#839496",themePromptColor:"#a917a8"},light:{themeBGColor:"#fdf6e4",themeToolbarColor:"#d8d8d8",themeColor:"#333333",themePromptColor:"#a917a8"},dracula:{themeBGColor:"#272B36",themeToolbarColor:"#DBDBDB",themeColor:"#FFFEFC",themePromptColor:"#a917a8"},"material-dark":{themeBGColor:"#151515",themeToolbarColor:"#424242",themeColor:"#fff",themePromptColor:"#42A5F5"},"material-light":{themeBGColor:"#fafafa",themeToolbarColor:"#424242",themeColor:"#151515",themePromptColor:"#42A5F5"},"material-ocean":{themeBGColor:"#263238",themeToolbarColor:"#37474F",themeColor:"#fff",themePromptColor:"#C3D82C"},matrix:{themeBGColor:"#0D0208",themeToolbarColor:"#0D0208",themeColor:"#00FF41",themePromptColor:"#008F11"}},u=e.createContext(null),m=function(n){var t=n.children,r=o(o({},s),t.props.themes||{}),a=r[t.props.theme]||r.light;return e.createElement(u.Provider,{value:a},t)};function d(n){var t=e.useContext(i),o=n.controlButtonLabels,r=n.showControlButtons?o.map((function(n){return e.createElement("div",{key:n,className:"".concat(t.consoleCtrl," ").concat(t[n])})})):null;return e.createElement("div",{className:t.controls},r)}var f=e.createContext(null),p=function(){function e(){}return e.splitStringAtIndex=function(e,n){return e?[e.substring(0,n),e.substring(n)]:["",""]},e}(),_=function(n,o,l,c,s,m,d){var _=e.useContext(i),h=e.useContext(u),x=e.useContext(f).appendCommandToHistory,b=e.useRef(null),g=e.useState(""),C=g[0],v=g[1],y=e.useState(!1),E=y[0],w=y[1],T=e.useState(0),k=T[0],B=T[1],S=e.useState(""),z=S[0],M=S[1],P=e.useState(""),R=P[0],A=P[1];e.useEffect((function(){t&&o&&b.current.focus()}),[o]),e.useEffect((function(){E&&x(C)}),[E]);var D=t&&m?e.createElement("div",{className:_.mobileInput},e.createElement("input",{type:"text",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",value:C,onChange:function(e){return v(e.target.value)},ref:b})):null,F=E?e.createElement(e.Fragment,null,D,e.createElement("div",{className:_.lineText},o&&n?e.createElement("span",{className:_.caret},e.createElement("span",{className:_.caretAfter,style:{background:h.themeColor}})):null)):e.createElement(e.Fragment,null,D,e.createElement("span",{style:{color:h.themePromptColor}},l),e.createElement("div",{className:_.lineText},e.createElement("span",{className:_.preWhiteSpace},z),o&&n?e.createElement("span",{className:_.caret},e.createElement("span",{className:_.caretAfter,style:{background:h.themeColor}})):null,e.createElement("span",{className:_.preWhiteSpace},R)));return function(n,t,o,r,a,l,i,c,s){var u=e.useContext(f),m=u.getPreviousCommand,d=u.getNextCommand,_=function(e){if(n&&s){e.preventDefault();var i=e.key;if("Enter"!==i){var c=null;if("Backspace"===i){var u=p.splitStringAtIndex(t,a),f=u[0],_=u[1];c=f.slice(0,-1)+_,t&&0!==t.length&&l(a-1)}else if("ArrowUp"===i)(c=m())&&l(c.length);else if("ArrowDown"===i)c=d(),l(c?c.length:0);else if("ArrowLeft"===i)a>0&&l(a-1),c=t;else if("ArrowRight"===i)a<t.length&&l(a+1),c=t;else if((e.metaKey||e.ctrlKey)&&"v"===i.toLowerCase())navigator.clipboard.readText().then((function(e){var n=p.splitStringAtIndex(t||"",a),r=n[0],i=n[1];c=r+e+i,l(a+e.length),o(c)}));else if((e.metaKey||e.ctrlKey)&&"c"===i.toLowerCase()){var h=window.getSelection().toString();navigator.clipboard.writeText(h).then((function(){o(c=t)}))}else if(i&&1===i.length){var x=p.splitStringAtIndex(t,a);f=x[0],_=x[1],c=f+i+_,l(a+1)}else c=t;o(c),r(!1)}else r(!0)}};e.useEffect((function(){return document.addEventListener("keydown",_),function(){document.removeEventListener("keydown",_)}})),e.useEffect((function(){var e=p.splitStringAtIndex(t,a),n=e[0],o=e[1];i(n),c(o)}),[t,a])}(o,C,v,w,k,B,M,A,m),function(n,t,o,l,c,s,m,d,p,_,h){var x=e.useContext(f),b=x.bufferedContent,g=x.setBufferedContent,C=e.useContext(i),v=e.useContext(u);e.useEffect((function(){var i;n&&(i=l,r(void 0,void 0,void 0,(function(){var n,r,u,f,x,y,E,w;return a(this,(function(a){switch(a.label){case 0:return n=i.trim().split(" "),r=n[0],u=n.slice(1),f="","clear"===r?(g(""),c(""),t(!1),s(0),m(""),d(""),[2]):(x=e.createElement(e.Fragment,null,b,e.createElement("span",{style:{color:v.themePromptColor}},o),e.createElement("span",{className:"".concat(C.lineText," ").concat(C.preWhiteSpace)},l),e.createElement("br",null)),g(x),c(""),s(0),m(""),d(""),i?(y=u.join(" "),r&&p[r]?"function"!=typeof(E=p[r])?[3,2]:[4,E(y)]:[3,4]):[3,9]);case 1:return f=a.sent(),[3,3];case 2:f=E,a.label=3;case 3:return[3,9];case 4:return"function"!=typeof h?[3,6]:[4,h(r,y)];case 5:return f=a.sent(),[3,9];case 6:return"function"!=typeof _?[3,8]:[4,_(r,y)];case 7:return f=a.sent(),[3,9];case 8:f=_,a.label=9;case 9:return w=e.createElement(e.Fragment,null,b,e.createElement("span",{style:{color:v.themePromptColor}},o),e.createElement("span",{className:"".concat(C.lineText," ").concat(C.preWhiteSpace)},l),f?e.createElement("span",null,e.createElement("br",null),f):null,e.createElement("br",null)),g(w),t(!1),[2]}}))})))}),[n])}(E,w,l,C,v,B,M,A,c,s,d),F};function h(n){var t=e.useRef(null),o=e.useContext(i),r=e.useContext(u),a=e.useContext(f).bufferedContent;!function(n,t){e.useEffect((function(){t.current&&(t.current.scrollTop=t.current.scrollHeight)}),[n])}(a,t);var l=n.enableInput,c=n.caret,s=n.consoleFocused,m=n.prompt,d=n.commands,p=n.welcomeMessage,h=n.errorMessage,x=n.showControlBar,b=n.defaultHandler,g=_(c,s,m,d,h,l,b);return e.createElement("div",{ref:t,className:"".concat(o.editor," ").concat(x?null:o.curvedTop," ").concat(x?o.editorWithTopBar:null),style:{background:r.themeBGColor}},p,a,g)}function x(n){var o,r,a,l,c=e.useRef(null),s=e.useState(!t),m=s[0],f=s[1],p=e.useContext(i),_=e.useContext(u);o=c,r=m,a=f,l=function(e){o.current&&!o.current.contains(e.target)?a(!1):a(!t||!r)},e.useEffect((function(){return document.addEventListener("mousedown",l),function(){document.removeEventListener("mousedown",l)}}));var x=n.caret,b=n.theme,g=n.showControlBar,C=n.showControlButtons,v=n.controlButtonLabels,y=n.prompt,E=n.commands,w=n.welcomeMessage,T=n.errorMessage,k=n.enableInput,B=n.defaultHandler,S=g?e.createElement(d,{consoleFocused:m,showControlButtons:C,controlButtonLabels:v}):null,z=e.createElement(h,{caret:x,consoleFocused:m,prompt:y,commands:E,welcomeMessage:w,errorMessage:T,enableInput:k,showControlBar:g,defaultHandler:B});return e.createElement("div",{ref:c,id:p.terminalContainer,className:p["theme--".concat(b)],"data-testid":"terminal"},e.createElement("div",{className:"".concat(p.terminal),style:{background:_.themeToolbarColor,color:_.themeColor}},S,z))}function b(n){var t=n.children;return e.createElement(c,null,e.createElement(m,null,t))}function g(n){return e.createElement(b,null,e.createElement(x,o({},n)))}x.propTypes={enableInput:n.bool,caret:n.bool,theme:n.string,showControlBar:n.bool,showControlButtons:n.bool,controlButtonLabels:n.arrayOf(n.string),prompt:n.string,commands:n.objectOf(n.oneOfType([n.string,n.func,n.node])),welcomeMessage:n.oneOfType([n.string,n.func,n.node]),errorMessage:n.oneOfType([n.string,n.func,n.node]),defaultHandler:n.func},x.defaultProps={enableInput:!0,caret:!0,theme:"light",showControlBar:!0,showControlButtons:!0,controlButtonLabels:["close","minimize","maximize"],prompt:">>>",commands:{},welcomeMessage:"",errorMessage:"not found!",defaultHandler:null};var C=function(n){var t=n.children,o=e.useState(""),r=o[0],a=o[1],l=e.useState([]),i=l[0],c=l[1],s=e.useState(null),u=s[0],m=s[1];e.useEffect((function(){m(i.length)}),[i]);return e.createElement(f.Provider,{value:{bufferedContent:r,setBufferedContent:a,appendCommandToHistory:function(e){e&&c(i.concat(e))},getPreviousCommand:function(){if(0===u)return 0===i.length?"":i[0];var e=i[u-1];return u>0&&m(u-1),e},getNextCommand:function(){if(u+1<=i.length){var e=i[u+1];return m(u+1),e}return""}}},t)},v={ReactTerminal:g,TerminalContextProvider:C};export{g as ReactTerminal,C as TerminalContextProvider,v as default};
