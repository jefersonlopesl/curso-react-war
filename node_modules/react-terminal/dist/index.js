"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("prop-types"),n=require("react-device-detect");function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function r(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,o.get?o:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var a=r(e),l=o(t),i=function(){return i=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},i.apply(this,arguments)};function c(e,t,n,o){return new(n||(n=Promise))((function(r,a){function l(e){try{c(o.next(e))}catch(e){a(e)}}function i(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,i)}c((o=o.apply(e,t||[])).next())}))}function s(e,t){var n,o,r,a,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return l.label++,{value:a[1],done:!1};case 5:l.label++,o=a[1],a=[0];continue;case 7:a=l.ops.pop(),l.trys.pop();continue;default:if(!(r=l.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){l=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){l.label=a[1];break}if(6===a[0]&&l.label<r[1]){l.label=r[1],r=a;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(a);break}r[2]&&l.ops.pop(),l.trys.pop();continue}a=t.call(e,l)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}}!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===n&&o.firstChild?o.insertBefore(r,o.firstChild):o.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}('@import url("https://fonts.googleapis.com/css?family=Source+Code+Pro&display=swap");\n#index_terminalContainer__3q4m3 {\n  --control-default-bg-color: #ccc;\n  --control-close-bg-color: #fc5b57;\n  --control-minimize-bg-color: #e5bf3c;\n  --control-maximize-bg-color: #57c038;\n}\n\n.index_controls__9z-dM {\n  text-align: left;\n  height: 26px;\n  position: relative;\n  top: 4px;\n  margin-left: 4px;\n}\n.index_controls__9z-dM .index_consoleCtrl__PQnAL {\n  display: inline-block;\n  width: 13px;\n  height: 13px;\n  margin: 0 3px;\n  border-radius: 50%;\n  background: var(--control-default-bg-color);\n}\n.index_controls__9z-dM .index_close__2o6CK {\n  background: var(--control-close-bg-color);\n}\n.index_controls__9z-dM .index_minimize__E9mwB {\n  background: var(--control-minimize-bg-color);\n}\n.index_controls__9z-dM .index_maximize__sbbYF {\n  background: var(--control-maximize-bg-color);\n}\n\n.index_editor__2tqRz {\n  text-align: left;\n  height: 100%;\n  padding: 10px 15px;\n  overflow-wrap: break-word;\n  overflow-y: scroll;\n  outline: none;\n  font-family: "Source Code Pro", monospace;\n  font-size: 18px;\n  line-height: 22px;\n  border-bottom-left-radius: 5px;\n  border-bottom-right-radius: 5px;\n}\n.index_editor__2tqRz .index_mobileInput__jGtyc {\n  position: absolute;\n  top: -2000px;\n  left: -2000px;\n}\n.index_editor__2tqRz .index_lineText__2Poex {\n  display: inline;\n  position: relative;\n  top: -1px;\n  margin-left: 8px;\n}\n.index_editor__2tqRz .index_preWhiteSpace__3nCT2 {\n  white-space: pre-wrap;\n}\n.index_editor__2tqRz .index_caret__MYxcn {\n  position: relative;\n  -webkit-animation: index_blink__RQDX- 0.75s ease-in-out infinite;\n  -moz-animation: index_blink__RQDX- 0.75s ease-in-out infinite;\n  -o-animation: index_blink__RQDX- 0.75s ease-in-out infinite;\n  -ms-animation: index_blink__RQDX- 0.75s ease-in-out infinite;\n  animation: index_blink__RQDX- 0.75s ease-in-out infinite;\n}\n.index_editor__2tqRz .index_caret__MYxcn .index_caretAfter__2B8sk {\n  content: "";\n  position: absolute;\n  top: 2px;\n  width: 10px;\n  height: 22px;\n  z-index: 10;\n}\n@-moz-keyframes index_blink__RQDX- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0);\n  }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none;\n  }\n}\n@-webkit-keyframes index_blink__RQDX- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0);\n  }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none;\n  }\n}\n@-o-keyframes index_blink__RQDX- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0);\n  }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none;\n  }\n}\n@keyframes index_blink__RQDX- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0);\n  }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none;\n  }\n}\n.index_editor__2tqRz a {\n  color: #1a87b5;\n}\n\n.index_editorWithTopBar__3SFSM {\n  height: calc(100% - 46px);\n}\n\n.index_curvedTop__3RecJ {\n  border-top-left-radius: 5px;\n  border-top-right-radius: 5px;\n}\n\n#index_terminalContainer__3q4m3 {\n  height: 100%;\n}\n\n.index_terminal__1dSq1 {\n  height: 100%;\n  width: 100%;\n  margin: auto;\n  border-radius: 5px;\n}');var u={terminalContainer:"index_terminalContainer__3q4m3",controls:"index_controls__9z-dM",consoleCtrl:"index_consoleCtrl__PQnAL",close:"index_close__2o6CK",minimize:"index_minimize__E9mwB",maximize:"index_maximize__sbbYF",editor:"index_editor__2tqRz",mobileInput:"index_mobileInput__jGtyc",lineText:"index_lineText__2Poex",preWhiteSpace:"index_preWhiteSpace__3nCT2",caret:"index_caret__MYxcn",blink:"index_blink__RQDX-",caretAfter:"index_caretAfter__2B8sk",editorWithTopBar:"index_editorWithTopBar__3SFSM",curvedTop:"index_curvedTop__3RecJ",terminal:"index_terminal__1dSq1"},d=a.createContext(null),m=function(e){var t=e.children;return a.createElement(d.Provider,{value:u},t)},f={dark:{themeBGColor:"#022833",themeToolbarColor:"#131519",themeColor:"#839496",themePromptColor:"#a917a8"},light:{themeBGColor:"#fdf6e4",themeToolbarColor:"#d8d8d8",themeColor:"#333333",themePromptColor:"#a917a8"},dracula:{themeBGColor:"#272B36",themeToolbarColor:"#DBDBDB",themeColor:"#FFFEFC",themePromptColor:"#a917a8"},"material-dark":{themeBGColor:"#151515",themeToolbarColor:"#424242",themeColor:"#fff",themePromptColor:"#42A5F5"},"material-light":{themeBGColor:"#fafafa",themeToolbarColor:"#424242",themeColor:"#151515",themePromptColor:"#42A5F5"},"material-ocean":{themeBGColor:"#263238",themeToolbarColor:"#37474F",themeColor:"#fff",themePromptColor:"#C3D82C"},matrix:{themeBGColor:"#0D0208",themeToolbarColor:"#0D0208",themeColor:"#00FF41",themePromptColor:"#008F11"}},p=a.createContext(null),_=function(e){var t=e.children,n=i(i({},f),t.props.themes||{}),o=n[t.props.theme]||n.light;return a.createElement(p.Provider,{value:o},t)};function h(e){var t=a.useContext(d),n=e.controlButtonLabels,o=e.showControlButtons?n.map((function(e){return a.createElement("div",{key:e,className:"".concat(t.consoleCtrl," ").concat(t[e])})})):null;return a.createElement("div",{className:t.controls},o)}var x=a.createContext(null),b=function(){function e(){}return e.splitStringAtIndex=function(e,t){return e?[e.substring(0,t),e.substring(t)]:["",""]},e}(),g=function(e,t,o,r,l,i,u){var m=a.useContext(d),f=a.useContext(p),_=a.useContext(x).appendCommandToHistory,h=a.useRef(null),g=a.useState(""),C=g[0],v=g[1],y=a.useState(!1),E=y[0],w=y[1],T=a.useState(0),k=T[0],B=T[1],S=a.useState(""),z=S[0],M=S[1],P=a.useState(""),R=P[0],A=P[1];a.useEffect((function(){n.isMobile&&t&&h.current.focus()}),[t]),a.useEffect((function(){E&&_(C)}),[E]);var D=n.isMobile&&i?a.createElement("div",{className:m.mobileInput},a.createElement("input",{type:"text",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",value:C,onChange:function(e){return v(e.target.value)},ref:h})):null,F=E?a.createElement(a.Fragment,null,D,a.createElement("div",{className:m.lineText},t&&e?a.createElement("span",{className:m.caret},a.createElement("span",{className:m.caretAfter,style:{background:f.themeColor}})):null)):a.createElement(a.Fragment,null,D,a.createElement("span",{style:{color:f.themePromptColor}},o),a.createElement("div",{className:m.lineText},a.createElement("span",{className:m.preWhiteSpace},z),t&&e?a.createElement("span",{className:m.caret},a.createElement("span",{className:m.caretAfter,style:{background:f.themeColor}})):null,a.createElement("span",{className:m.preWhiteSpace},R)));return function(e,t,n,o,r,l,i,c,s){var u=a.useContext(x),d=u.getPreviousCommand,m=u.getNextCommand,f=function(a){if(e&&s){a.preventDefault();var i=a.key;if("Enter"!==i){var c=null;if("Backspace"===i){var u=b.splitStringAtIndex(t,r),f=u[0],p=u[1];c=f.slice(0,-1)+p,t&&0!==t.length&&l(r-1)}else if("ArrowUp"===i)(c=d())&&l(c.length);else if("ArrowDown"===i)c=m(),l(c?c.length:0);else if("ArrowLeft"===i)r>0&&l(r-1),c=t;else if("ArrowRight"===i)r<t.length&&l(r+1),c=t;else if((a.metaKey||a.ctrlKey)&&"v"===i.toLowerCase())navigator.clipboard.readText().then((function(e){var o=b.splitStringAtIndex(t||"",r),a=o[0],i=o[1];c=a+e+i,l(r+e.length),n(c)}));else if((a.metaKey||a.ctrlKey)&&"c"===i.toLowerCase()){var _=window.getSelection().toString();navigator.clipboard.writeText(_).then((function(){n(c=t)}))}else if(i&&1===i.length){var h=b.splitStringAtIndex(t,r);f=h[0],p=h[1],c=f+i+p,l(r+1)}else c=t;n(c),o(!1)}else o(!0)}};a.useEffect((function(){return document.addEventListener("keydown",f),function(){document.removeEventListener("keydown",f)}})),a.useEffect((function(){var e=b.splitStringAtIndex(t,r),n=e[0],o=e[1];i(n),c(o)}),[t,r])}(t,C,v,w,k,B,M,A,i),function(e,t,n,o,r,l,i,u,m,f,_){var h=a.useContext(x),b=h.bufferedContent,g=h.setBufferedContent,C=a.useContext(d),v=a.useContext(p);a.useEffect((function(){var d;e&&(d=o,c(void 0,void 0,void 0,(function(){var e,c,p,h,x,y,E,w;return s(this,(function(s){switch(s.label){case 0:return e=d.trim().split(" "),c=e[0],p=e.slice(1),h="","clear"===c?(g(""),r(""),t(!1),l(0),i(""),u(""),[2]):(x=a.createElement(a.Fragment,null,b,a.createElement("span",{style:{color:v.themePromptColor}},n),a.createElement("span",{className:"".concat(C.lineText," ").concat(C.preWhiteSpace)},o),a.createElement("br",null)),g(x),r(""),l(0),i(""),u(""),d?(y=p.join(" "),c&&m[c]?"function"!=typeof(E=m[c])?[3,2]:[4,E(y)]:[3,4]):[3,9]);case 1:return h=s.sent(),[3,3];case 2:h=E,s.label=3;case 3:return[3,9];case 4:return"function"!=typeof _?[3,6]:[4,_(c,y)];case 5:return h=s.sent(),[3,9];case 6:return"function"!=typeof f?[3,8]:[4,f(c,y)];case 7:return h=s.sent(),[3,9];case 8:h=f,s.label=9;case 9:return w=a.createElement(a.Fragment,null,b,a.createElement("span",{style:{color:v.themePromptColor}},n),a.createElement("span",{className:"".concat(C.lineText," ").concat(C.preWhiteSpace)},o),h?a.createElement("span",null,a.createElement("br",null),h):null,a.createElement("br",null)),g(w),t(!1),[2]}}))})))}),[e])}(E,w,o,C,v,B,M,A,r,l,u),F};function C(e){var t=a.useRef(null),n=a.useContext(d),o=a.useContext(p),r=a.useContext(x).bufferedContent;!function(e,t){a.useEffect((function(){t.current&&(t.current.scrollTop=t.current.scrollHeight)}),[e])}(r,t);var l=e.enableInput,i=e.caret,c=e.consoleFocused,s=e.prompt,u=e.commands,m=e.welcomeMessage,f=e.errorMessage,_=e.showControlBar,h=e.defaultHandler,b=g(i,c,s,u,f,l,h);return a.createElement("div",{ref:t,className:"".concat(n.editor," ").concat(_?null:n.curvedTop," ").concat(_?n.editorWithTopBar:null),style:{background:o.themeBGColor}},m,r,b)}function v(e){var t,o,r,l,i=a.useRef(null),c=a.useState(!n.isMobile),s=c[0],u=c[1],m=a.useContext(d),f=a.useContext(p);t=i,o=s,r=u,l=function(e){t.current&&!t.current.contains(e.target)?r(!1):n.isMobile?r(!o):r(!0)},a.useEffect((function(){return document.addEventListener("mousedown",l),function(){document.removeEventListener("mousedown",l)}}));var _=e.caret,x=e.theme,b=e.showControlBar,g=e.showControlButtons,v=e.controlButtonLabels,y=e.prompt,E=e.commands,w=e.welcomeMessage,T=e.errorMessage,k=e.enableInput,B=e.defaultHandler,S=b?a.createElement(h,{consoleFocused:s,showControlButtons:g,controlButtonLabels:v}):null,z=a.createElement(C,{caret:_,consoleFocused:s,prompt:y,commands:E,welcomeMessage:w,errorMessage:T,enableInput:k,showControlBar:b,defaultHandler:B});return a.createElement("div",{ref:i,id:m.terminalContainer,className:m["theme--".concat(x)],"data-testid":"terminal"},a.createElement("div",{className:"".concat(m.terminal),style:{background:f.themeToolbarColor,color:f.themeColor}},S,z))}function y(e){var t=e.children;return a.createElement(m,null,a.createElement(_,null,t))}function E(e){return a.createElement(y,null,a.createElement(v,i({},e)))}v.propTypes={enableInput:l.default.bool,caret:l.default.bool,theme:l.default.string,showControlBar:l.default.bool,showControlButtons:l.default.bool,controlButtonLabels:l.default.arrayOf(l.default.string),prompt:l.default.string,commands:l.default.objectOf(l.default.oneOfType([l.default.string,l.default.func,l.default.node])),welcomeMessage:l.default.oneOfType([l.default.string,l.default.func,l.default.node]),errorMessage:l.default.oneOfType([l.default.string,l.default.func,l.default.node]),defaultHandler:l.default.func},v.defaultProps={enableInput:!0,caret:!0,theme:"light",showControlBar:!0,showControlButtons:!0,controlButtonLabels:["close","minimize","maximize"],prompt:">>>",commands:{},welcomeMessage:"",errorMessage:"not found!",defaultHandler:null};var w=function(e){var t=e.children,n=a.useState(""),o=n[0],r=n[1],l=a.useState([]),i=l[0],c=l[1],s=a.useState(null),u=s[0],d=s[1];a.useEffect((function(){d(i.length)}),[i]);return a.createElement(x.Provider,{value:{bufferedContent:o,setBufferedContent:r,appendCommandToHistory:function(e){e&&c(i.concat(e))},getPreviousCommand:function(){if(0===u)return 0===i.length?"":i[0];var e=i[u-1];return u>0&&d(u-1),e},getNextCommand:function(){if(u+1<=i.length){var e=i[u+1];return d(u+1),e}return""}}},t)},T={ReactTerminal:E,TerminalContextProvider:w};exports.ReactTerminal=E,exports.TerminalContextProvider=w,exports.default=T;
